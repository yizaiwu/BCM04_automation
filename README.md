# BCM04 JavaScript 自動化腳本

這是一個用於自動化執行 BCM04 報表填寫流程的 JavaScript 腳本。旨在簡化重複性的表單填寫與點擊操作，提升工作效率。

## 功能特色

- **全流程自動化**：整合 BCM04-1 至 BCM04-5 的操作流程。
- **智能檢核**：自動檢查「已確認」欄位，跳過已處理過的客戶，避免重複作業。
- **自動填單**：自動選擇下拉選單（客戶來源、聯繫管道、聯繫結果等）並移動指定項目。
- **強韌性設計**：包含 DOM 強力搜尋與重試機制，適應網頁載入延遲。

## 執行方式

1. 複製 `BCM04_automation.js` 檔案中的完整程式碼。
2. 在瀏覽器中打開要自動化執行的 BCM04 報表頁面。
3. 打開開發者工具主控台 (Console)：
   - 按下鍵盤快速鍵 `F12` 或 `Ctrl` + `Shift` + `I`。
   - 或者點擊瀏覽器選單，選擇「更多工具」>「開發者工具」，並切換到 **Console** (主控台) 分頁。
4. 在 Console 中貼上程式碼 (`Ctrl` + `V`)，然後按下 `Enter` 鍵開始執行。

## 常見問題排除

### 遇到「已在偵錯工具中暫停」(Paused in debugger)

如果程式執行過程中停止，並出現「已在偵錯工具中暫停」的訊息，這通常是因為 Chrome 開發者工具開啟了**「發生例外狀況時暫停」**的功能。

當網頁原本的程式碼（非本自動化腳本）拋出任何微小的錯誤時，瀏覽器會強制中斷腳本執行，導致自動化流程卡住。

**解決步驟：**

1. **停用中斷點**：在開發者工具中，按下快速鍵 `Ctrl` + `F8`（或點擊「停用中斷點」圖示）。
2. **繼續執行**：按下快速鍵 `F8`（或點擊「繼續執行指令碼」圖示）即可恢復執行。

## 開發提示詞

僅供參考，建議不要一次全部丟給AI開發，通常AI一次開發的不能用，分段開發完成的時間，會比AI一次開發完再除錯的時間，來得更有效率。

請寫一個自動化簽核JavaScript
１使用者先點選BCM04-1的「查詢」
２然後尋找「客戶數」欄位有星號「*」的數字去點選
３接著點選BCM04-2的「客戶姓名」欄位的第一個客戶
４接著點選BCM04-3「客戶首頁」的「互動紀錄」的「更多>>」按鈕
５接著點選BCM04-4「互動紀錄查詢」的「新增」。
６接著在BCM04-5「互動記錄新增」的每一個欄位都選第一項如下：
客戶來源：既有客戶
聯繫管道：資料檢視
聯繫結果：資料檢視
聯繫花費時間：0~5分鐘
請選擇「定期檢視淨值管理效益，持續關心客戶。」，然後再按「>」按鈕，將「定期檢視淨值管理效益，持續關心客戶。」移到右邊欄位。最後點選「確定」。
接著關閉BCM04-4「互動紀錄查詢」，接著關閉BCM04-3「客戶首頁」。
７回到BCM04-2之後重新選擇「客戶姓名」欄位的第一個客戶，重複以上３～６的動作。直到BCM04-2沒有任何資料，接著關閉BCM04-2回到BCM04-1，繼續尋找BCM04-1「客戶數」欄位有星號「*」的數字，如無，則顯示「自動化簽核報表已完成！」